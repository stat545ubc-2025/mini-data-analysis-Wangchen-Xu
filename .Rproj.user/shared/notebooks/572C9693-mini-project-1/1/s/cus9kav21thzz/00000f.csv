"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(datateachr)"
"0",""
"0","sg_sub <- datateachr::steam_games %>%"
"0","  mutate("
"0","    # safe coercion: factor/character -> numeric; numeric stays numeric"
"0","    orig_price   = as.numeric(as.character(original_price)),"
"0","    disc_price   = as.numeric(as.character(discount_price)),"
"0","    # get year from a YYYY-MM-DD string (works without extra packages)"
"0","    release_year = as.integer(substr(as.character(release_date), 1, 4)),"
"0","    discount_rate = (orig_price - disc_price) / orig_price"
"0","  ) %>%"
"0","  # keep valid, recent rows; ensure it's a real discount"
"0","  filter(!is.na(orig_price), !is.na(disc_price), !is.na(release_year),"
"0","         orig_price > 0, disc_price >= 0, disc_price <= orig_price,"
"0","         release_year >= 2015) %>%"
"0","  select(name, release_year, orig_price, disc_price, discount_rate)"
"0",""
"0","# Plot the distribution of discount_rate"
"0","ggplot(sg_sub, aes(x = discount_rate)) +"
"0","  geom_histogram(bins = 30, na.rm = TRUE) +"
"0","  labs(title = ""Discount rate distribution (release_year â‰¥ 2015)"","
"0","       x = ""Discount rate"", y = ""Count"") +"
"0","  theme(plot.title = element_text(hjust = 0.5))"
"0",""
